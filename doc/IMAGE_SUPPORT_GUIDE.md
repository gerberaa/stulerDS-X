# üì∑ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∑–æ–±—Ä–∞–∂–µ–Ω—å –≤ Telegram Monitor Bot

## üÜï –ù–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å

–ë–æ—Ç —Ç–µ–ø–µ—Ä –ø—ñ–¥—Ç—Ä–∏–º—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫—É –∑–æ–±—Ä–∞–∂–µ–Ω—å –∑:
- **Twitter/X —Ç–≤—ñ—Ç—ñ–≤** - –≤—Å—ñ —Ñ–æ—Ç–æ –∑ —Ç–≤—ñ—Ç—ñ–≤
- **Discord –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å** - –≤–∫–ª–∞–¥–µ–Ω–Ω—è —Ç–∞ embed –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è

## üîß –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

### Twitter/X –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

#### Selenium Twitter Monitor
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏—è–≤–ª—è—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ —Ç–≤—ñ—Ç–∞—Ö
- –ü—ñ–¥—Ç—Ä–∏–º—É—î –º–Ω–æ–∂–∏–Ω–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è (–¥–æ 5 –Ω–∞ —Ç–≤—ñ—Ç)
- –í–∏—Ç—è–≥—É—î –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ URL –∑–æ–±—Ä–∞–∂–µ–Ω—å
- –í—ñ–¥–ø—Ä–∞–≤–ª—è—î –∫–æ–∂–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –æ–∫—Ä–µ–º–æ –∑ –ø—ñ–¥–ø–∏—Å–æ–º

#### –ó–≤–∏—á–∞–π–Ω–∏–π Twitter Monitor
- –ü—ñ–¥—Ç—Ä–∏–º—É—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ HTML –ø–∞—Ä—Å–∏–Ω–≥
- –í–∏—Ç—è–≥—É—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ JSON –¥–∞–Ω–∏—Ö Twitter

### Discord –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

#### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ —Ç–∏–ø–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å:
- **Attachments** - —Ñ–∞–π–ª–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏
- **Embeds** - –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ embed –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è—Ö
- **Thumbnails** - –º—ñ–Ω—ñ–∞—Ç—é—Ä–∏ –≤ embed

## üìã –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å

#### Twitter
```python
def _extract_tweet_images(self, element) -> List[str]:
    """–í–∏—Ç—è–≥—Ç–∏ URL —Ñ–æ—Ç–æ –∑ —Ç–≤—ñ—Ç–∞"""
    images = []
    
    # –°–µ–ª–µ–∫—Ç–æ—Ä–∏ –¥–ª—è –ø–æ—à—É–∫—É –∑–æ–±—Ä–∞–∂–µ–Ω—å
    image_selectors = [
        'img[src*="media"]',
        'img[src*="pbs.twimg.com"]',
        'img[alt*="Image"]',
        '[data-testid="tweetPhoto"] img',
        'div[data-testid="tweetPhoto"] img'
    ]
    
    # –í–∏—Ç—è–≥—É—î–º–æ —Ç–∞ –æ—á–∏—â–∞—î–º–æ URL
    for selector in image_selectors:
        img_elements = element.find_elements(By.CSS_SELECTOR, selector)
        for img in img_elements:
            src = img.get_attribute('src')
            if src and ('media' in src or 'pbs.twimg.com' in src):
                clean_url = src.split('?')[0]  # –í–∏–¥–∞–ª—è—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
                images.append(clean_url)
    
    return images
```

#### Discord
```python
def _extract_message_images(self, message: Dict) -> List[str]:
    """–í–∏—Ç—è–≥—Ç–∏ URL —Ñ–æ—Ç–æ –∑ Discord –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
    images = []
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ attachments
    attachments = message.get('attachments', [])
    for attachment in attachments:
        if attachment.get('content_type', '').startswith('image/'):
            url = attachment.get('url')
            if url:
                images.append(url)
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ embeds
    embeds = message.get('embeds', [])
    for embed in embeds:
        if 'image' in embed:
            image_url = embed['image'].get('url')
            if image_url:
                images.append(image_url)
        
        if 'thumbnail' in embed:
            thumb_url = embed['thumbnail'].get('url')
            if thumb_url:
                images.append(thumb_url)
    
    return images
```

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞

```python
def download_and_send_image(image_url: str, chat_id: str, caption: str = "") -> bool:
    """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ Telegram"""
    try:
        # –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
        }
        
        response = requests.get(image_url, headers=headers, timeout=10)
        response.raise_for_status()
        
        # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Ä–æ–∑–º—ñ—Ä (–º–∞–∫—Å–∏–º—É–º 20MB –¥–ª—è Telegram)
        if len(response.content) > 20 * 1024 * 1024:
            return False
        
        # –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª
        with tempfile.NamedTemporaryFile(delete=False, suffix='.jpg') as temp_file:
            temp_file.write(response.content)
            temp_file_path = temp_file.name
        
        try:
            # –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —á–µ—Ä–µ–∑ Telegram API
            url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendPhoto"
            
            with open(temp_file_path, 'rb') as photo_file:
                files = {'photo': photo_file}
                data = {
                    'chat_id': chat_id,
                    'caption': caption[:1024],  # –û–±–º–µ–∂–µ–Ω–Ω—è Telegram
                    'parse_mode': 'Markdown'
                }
                
                response = requests.post(url, files=files, data=data, timeout=30)
                return response.status_code == 200
                
        finally:
            # –í–∏–¥–∞–ª—è—î–º–æ —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª
            os.unlink(temp_file_path)
            
    except Exception as e:
        logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è/–≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è: {e}")
        return False
```

## üéØ –§–æ—Ä–º–∞—Ç —Å–ø–æ–≤—ñ—â–µ–Ω—å

### Twitter –∑ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º–∏
```
üê¶ **–ù–æ–≤–∏–π —Ç–≤—ñ—Ç –∑ Twitter**
‚Ä¢ –ü—Ä–æ—Ñ—ñ–ª—å: @username
‚Ä¢ –ê–≤—Ç–æ—Ä: Display Name
‚Ä¢ –î–∞—Ç–∞: 13 September, 16:30 UTC (2 –≥–æ–¥–∏–Ω–∏ —Ç–æ–º—É)
‚Ä¢ –¢–µ–∫—Å—Ç: –¢–≤—ñ—Ç –∑ —Ñ–æ—Ç–æ...
üì∑ –ó–æ–±—Ä–∞–∂–µ–Ω—å: 2
üîó [–ü–µ—Ä–µ–π—Ç–∏ –¥–æ —Ç–≤—ñ—Ç–∞](https://x.com/username/status/123)

[–ü–æ—Ç—ñ–º –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –æ–∫—Ä–µ–º–æ]
üì∑ Twitter –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è 1/2
üì∑ Twitter –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è 2/2
```

### Discord –∑ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º–∏
```
üì¢ **–ù–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ Discord**
‚Ä¢ –°–µ—Ä–≤–µ—Ä: Discord Server (123456789)
‚Ä¢ –ê–≤—Ç–æ—Ä: Username
‚Ä¢ –î–∞—Ç–∞: 13 September, 16:30 UTC (2 –≥–æ–¥–∏–Ω–∏ —Ç–æ–º—É)
‚Ä¢ –¢–µ–∫—Å—Ç: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ —Ñ–æ—Ç–æ...
üì∑ –ó–æ–±—Ä–∞–∂–µ–Ω—å: 1
üîó [–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è](https://discord.com/channels/...)

[–ü–æ—Ç—ñ–º –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è]
üì∑ Discord –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
```

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### Chrome/Selenium –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
```python
# –î–æ–∑–≤–æ–ª—è—î–º–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ Chrome
prefs = {
    "profile.managed_default_content_settings.images": 1,  # –î–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
    "profile.default_content_setting_values.notifications": 2,
    "profile.managed_default_content_settings.media_stream": 1
}
chrome_options.add_experimental_option("prefs", prefs)
```

### –û–±–º–µ–∂–µ–Ω–Ω—è
- **–ú–∞–∫—Å–∏–º—É–º –∑–æ–±—Ä–∞–∂–µ–Ω—å**: 5 –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è/—Ç–≤—ñ—Ç
- **–†–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É**: –¥–æ 20MB (–æ–±–º–µ–∂–µ–Ω–Ω—è Telegram)
- **–ó–∞—Ç—Ä–∏–º–∫–∞ –º—ñ–∂ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º–∏**: 1 —Å–µ–∫—É–Ω–¥–∞
- **Timeout –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è**: 10 —Å–µ–∫—É–Ω–¥
- **Caption –æ–±–º–µ–∂–µ–Ω–Ω—è**: 1024 —Å–∏–º–≤–æ–ª–∏

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ:
```bash
python test_image_functionality.py
```

–¢–µ—Å—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î:
- ‚úÖ –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å –∑ Twitter
- ‚úÖ –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å –∑ Discord
- ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å
- ‚úÖ –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å

## üêõ –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–µ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-–∑'—î–¥–Ω–∞–Ω–Ω—è
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ URL –∑–æ–±—Ä–∞–∂–µ–Ω—å –¥–æ—Å—Ç—É–ø–Ω—ñ
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—ñ–≤ (–º–∞–∫—Å–∏–º—É–º 20MB)
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–æ–º–∏–ª–∫–∏

### Selenium –Ω–µ –±–∞—á–∏—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ Chrome –¥–æ–∑–≤–æ–ª—è—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –ø—Ä–æ—Ñ—ñ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π
3. –°–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –±–µ–∑ headless —Ä–µ–∂–∏–º—É

### Discord –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–µ –≤–∏—Ç—è–≥—É—é—Ç—å—Å—è
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Discord authorization —Ç–æ–∫–µ–Ω
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ –±–æ—Ç –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –∫–∞–Ω–∞–ª—É
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–æ—Ä–º–∞—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (attachments/embeds)

## üìà –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
- –¢–∏–º—á–∞—Å–æ–≤—ñ —Ñ–∞–π–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è
- –ó–∞—Ç—Ä–∏–º–∫–∏ –º—ñ–∂ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º–∏ –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è rate limit
- –û–±–º–µ–∂–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–æ–±—Ä–∞–∂–µ–Ω—å
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É —Ñ–∞–π–ª—ñ–≤ –ø–µ—Ä–µ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º

### –õ–æ–≥—É–≤–∞–Ω–Ω—è
- –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—É –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å
- –ü–æ–º–∏–ª–∫–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è/–≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ª–æ–≥—É—é—Ç—å—Å—è
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–Ω–∞–π–¥–µ–Ω–∏—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å

## üîÑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó

–Ø–∫—â–æ —É –≤–∞—Å –≤–∂–µ —î —Ä–æ–±–æ—á–∞ –≤–µ—Ä—Å—ñ—è –±–æ—Ç–∞:

1. **–û–Ω–æ–≤—ñ—Ç—å —Ñ–∞–π–ª–∏**:
   - `selenium_twitter_monitor.py` - –¥–æ–¥–∞–Ω–æ –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å
   - `discord_monitor.py` - –¥–æ–¥–∞–Ω–æ –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å
   - `bot.py` - –¥–æ–¥–∞–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å –±–æ—Ç–∞** - –Ω–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∞–∫—Ç–∏–≤—É—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ

3. **–ü—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ** - –∑–∞–ø—É—Å—Ç—ñ—Ç—å `test_image_functionality.py`

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä –≤–∞—à –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
- üîç –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ Twitter —Ç–≤—ñ—Ç–∞—Ö
- üîç –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ Discord –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è—Ö
- üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
- üì§ –í—ñ–¥–ø—Ä–∞–≤–ª—è—î —ó—Ö –≤ Telegram –∫–∞–Ω–∞–ª
- üìù –î–æ–¥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω—å –≤ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è

–í—Å—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –∑ –ø—ñ–¥–ø–∏—Å–∞–º–∏ —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—É —è–∫—ñ—Å—Ç—å!